## Iteration 1

Task: Remove unused InitOptions type and _options parameter from init.ts

Completed:
- Scanned src/ codebase for code smells using ts-prune and manual analysis
- Documented 14 issues in PRD.md (3 high, 5 medium, 4 low, 2 style)
- Removed unused InitOptions type export (line 99)
- Removed unused _options parameter from runInit function (line 151)
- Verified call site in index.tsx only passes repoRoot

Files changed:
- src/commands/init.ts: Removed InitOptions type, simplified runInit signature
- .ralph/PRD.md: Added comprehensive list of code smell tasks

Tests: All 86 tests passing
Type check: Clean
Lint: Clean

## Iteration 2

Task: Consolidate formatDuration - remove duplicate from webserver.ts

Completed:
- Identified 3 instances of formatDuration: utils.ts (canonical), webserver.ts server-side (duplicate), webserver.ts client-side JS (needed for browser)
- Added import of formatDuration from utils.js to webserver.ts
- Removed duplicate server-side formatDuration function (lines 226-241)
- Kept client-side JavaScript version in HTML template (runs in browser, cannot import)

Files changed:
- src/lib/webserver.ts: Added import, removed duplicate function

Reasoning: utils.ts is the single source of truth for shared utilities. Client-side JS in HTML template must remain separate as it executes in browser context.

Tests: All 86 tests passing
Type check: Clean
Lint: Clean

## Iteration 3

Task: Fix error handling in use-claude.ts catch block - add debug logging

Completed:
- Changed catch block parameter from _error to error (line 169)
- Added DEBUG-guarded error logging with detailed information (name, message, stack)
- Improved status message to differentiate "Cancelled" vs "Failed" based on error type
- Detects AbortError by checking error.name and message for abort signals

Files changed:
- src/hooks/use-claude.ts: Enhanced catch block with debug logging and better status

Reasoning: Swallowed errors reduce debuggability. Debug logging follows codebase pattern (process.env.DEBUG). Distinguishing cancellation from failure improves UX.

Tests: All 86 tests passing
Type check: Clean
Lint: Clean
Format: Applied (1 file formatted)
